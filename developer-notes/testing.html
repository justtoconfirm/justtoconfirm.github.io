<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Developer Notes - Testing & TDD</title>

    <link rel="shortcut icon" type="image/ico" href="img/favicon/code.ico" />
    <link rel="stylesheet" href="styles/main.css" />
    <link rel="preload" href="fonts/nunito-v9-latin-regular.woff2" as="font" type="font/woff2" crossorigin />
</head>
<body>

<!-- https://airbnb.io/enzyme/docs/installation/react-16.html -->
<!-- https://jestjs.io/ -->
<!-- https://marmelab.com/blog/2015/06/24/jest-in-practice.html -->
<!-- https://medium.com/wehkamp-techblog/unit-testing-your-react-application-with-jest-and-enzyme-81c5545cee45 -->
<!-- https://medium.com/codeclan/testing-react-with-jest-and-enzyme-20505fec4675 -->
<!-- https://code.tutsplus.com/articles/the-beginners-guide-to-unit-testing-what-is-unit-testing--wp-25728 -->
<!-- https://www.guru99.com/unit-testing-guide.html -->

<header class="header" role="banner">
    <nav class="header__inner">
        <ul class="header__item header__item--links">
            <li class="header__link">
                <span class="header__link--background">
                    <a href="index.html">Home</a>
                </span>
            </li>
            <li class="header__link">
                <span class="header__link--background">
                    <a href="#main">Skip to content</a>
                </span>
            </li>
        </ul>
    </nav>
</header>

<main role="main" id="main">
    <h1>Testing &amp; TDD (Test Driven Development)</h1>

    <h2>Unit Testing</h2>

    <p>Unit testing is the practice of testing certain functions and areas, or units, of our code. This gives us the ability to verify that our functions work as expected. As you begin to write more and more tests, you end up creating a suite of tests that you can run at any time during development.</p>

    <h2>Jest</h2>

    <p>Jest is the de facto unit testing framework for React. It is provided and used by Facebook themselves. The main advantage for using Jest is that it has zero configuration. It can be installed quickly (included with CRA - create-react-app) and is simple to use. Place you tests, files with '.js' extension, in a __tests__ folder, or name your test files with a '.spec.js' or '.test.js' extension. Whatever you prefer, Jest will find and run your tests.</p>

    <p>Jest acts as a test runner, assertion library, and mocking library. Jest also provides Snapshot testing. This is the ability to create a rendered 'snapshot' of a component to compare it to a previously saved 'snapshot'. The test will fail if the two do not match. Snapshots will be saved for you beside the test file that created them in an auto-generated __snapshots__ folder.</p>

    <h3>Install Jest</h3>

    <p>Install Jest as a devDependency using NPM (Node Package Manager).</p>

    <pre>
        <code>
<!-- leave this line empty -->
$ npm install jest --save-dev
        </code>
    </pre>

    <h2>Enzyme</h2>

    <p>Enzyme is a testing utility created by Airbnb that can be used together with Jest. Enzyme makes it easier to assert, manipulate, and traverse your React components' output. This adds some additional utility methods for rendering a component, find elements, and interacting with elements.</p>

    <p>Jest can be used with other JavaScript applications, but Enzyme only works with React. If Jest is not used, Enzyme must be paired with another test runner.</p>

    <p>Jest can be used without Enzyme to render components and test with snapshots, Enzyme simply adds additional functionality.</p>

    <p>Enzyme is not included with the CRA (create-react-app) tool, so it must be installed in addition.</p>

    <h3>Install Enzyme</h3>

    <p>If you are wanting to use Enzyme with React 16, simply install it as a devDependency with NPM (Node Package Manager). This will install both Enzyme and Enzyme Adapter.</p> 

    <pre>
        <code>
<!-- leave this line empty -->
$ npm install enzyme enzyme-adapter-react-16 --save-dev
        </code>
    </pre>

    <p>When you try to run tests following installation, an error may occur within the terminal. You may need to configure Enzyme so it can be used with React 16 and Jest.</p>

    <p>In the 'src/js' directory of your application, create a file named 'setupTests.js' and add the following code:</p>

    <pre>
        <code>
<!-- leave this line empty -->
// src/js/setupTests.js

import { configure } from 'enzyme'
import Adapter from 'enzyme-adapter-react-16'

configure({
    adapter: new Adapter()
})
        </code>
    </pre>

    <p>Next, update the package.json file to include a reference to the path of this config file when running Jest.</p>

    <pre>
        <code>
<!-- leave this line empty -->
"jest": {
    "setupTestFrameworkScriptFile": "&lt;rootDir&gt;/src/js/setupTests.js"
},
        </code>
    </pre>

    <p>We should already have a build script within our package.json file to run tests.</p>

    <pre>
        <code>
<!-- leave this line empty -->
"scripts": {
    "test": "jest"
},
        </code>
    </pre>

    <p>Once everything has been done, the tests can be executed by running the build script in the terminal.</p>

    <pre>
        <code>
<!-- leave this line empty -->
$ npm run test
        </code>
    </pre>

    <h2>Mocha</h2>

    <p>Mocha is a JavaScript test framework that runs using NodeJS and from within the browser. Jest and Jasmine are alternatives to Mocha. Unlike Jest, Mocha does not have an assertion library, a tool used to verify that things are correct. Assertion libraries such as Expect or Chai can be used with Mocha.</p>

    <h3>Install Mocha</h3>

    <p>Mocha can be installed using NPM (Node Package Manager). It should be installed as a devDependency.</p>

    <pre>
        <code>
<!-- leave this line empty -->
$ npm install mocha --save-dev
        </code>
    </pre>

    <p>By default, Mocha looks for a 'test' directory containing test files. You may need to create a directory in the root of your application for Mocha to work correctly.</p>

    <pre>
        <code>
<!-- leave this line empty -->
$ mkdir test
        </code>
    </pre>

    <p>The 'test' directory would where we can place all our test files. However, we may want to place our test files near to our components.</p>

    <p>We can continue to have a 'test' directory within the root of our project, but will contain two config file - setup.js and mocha.opts</p>

    <pre>
        <code>
<!-- leave this line empty -->
app /
    test /
        mocha.opts
        setup.js
        </code>
    </pre>

    <p>The mocha.opts file will look like this:</p>

    <pre>
        <code>
<!-- leave this line empty -->
test/setup.js
src/**/*.spec.js
        </code>
    </pre>

    <p>The setup.js file will look like this:</p>

    <pre>
        <code>
<!-- leave this line empty -->
const chai = require('chai');
        </code>
    </pre>

    <h3>Chai</h3>

    <p>This is assuming that Chai is to be used as the assertion library and has been installed.</p>

    <pre>
        <code>
<!-- leave this line empty -->
$ npm install chai --save-dev
        </code>
    </pre>

    <p>Node has its own built-in assertion module, named Assert, should you not want to use Chai.</p>

    <p>Any test file created for the React components should have the file extension of '.spec.js'. Using this configuration allows us to place the test file(s) in the same directory as our components.</p>

    <p>An example showing a possible file structure:</p>

    <pre>
        <code>
<!-- leave this line empty -->
app /
    src/
        components/
            1-atoms/
                input/
                    Input.js
                    Input.spec.js
    test /
        mocha.opts
        setup.js
        </code>
    </pre>

    <p>As with Jest, we can run Mocha using a simple build script in package.json.</p>

    <pre>
        <code>
<!-- leave this line empty -->
"scripts": {
    "test": "mocha"
},
        </code>
    </pre>

    <h3>Mocha &amp; ES6</h3>

    <p>Should you want to use JavaScript ES6 syntax within your test files, when using Mocha, you will need to make a few amendments. Babel will need to be setup within your build process and the mocha.opts file will need to be updated to allow for ES6.</p>

    <pre>
        <code>
<!-- leave this line empty -->
--require babel-register

test/setup.js
src/**/*.spec.js
        </code>
    </pre>

    <p>Next, update the package.json file:</p>

    <pre>
        <code>
<!-- leave this line empty -->
"babel": {
    "presets": ["env"]
}
        </code>
    </pre>

    <p>And here is an example test file:</p>

    <pre>
        <code>
<!-- leave this line empty -->
import React from 'react'
import { assert } from 'chai'

describe('Input', function() {
   it('test test', function() {
      // assert function from Chai
      assert.equal(true);
   });
})
        </code>
    </pre>

    <h2>Writing Tests</h2>

    <p>Using Jest it is possible to create a test file for a React component in any directory provided that are named as '.spec.js' or '.test.js'. Jest doesn't require a 'test' directory.</p>

    <p>Once a React component has been built, we can write a simple test. As an example, we can create a simple Button component named 'Button.js' and then write a test file named 'Button.test.js'.</p>

    <p>The test code for the Button component may look something like this:</p>

    <pre>
        <code>
<!-- leave this line empty -->
import React from 'react'
import { shallow } from 'enzyme'
import Button from './Button'

describe('&lt;Button/&gt;', () => {
    it('should render without throwing an error', () => {
        expect(shallow(&lt;Button/&gt;).find('.btn').exists()).toBe(true)
    })
})
        </code>
    </pre>

    <p>Ideally, this should be placed in the same directory as the Button component itself.</p>
</main>

</body>
</html>