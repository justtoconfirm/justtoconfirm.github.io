<!DOCTYPE html>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="An introduction to Heroku">

	<title>Codebox - Heroku</title>

	<link rel="shortcut icon" type="image/ico" href="favicon/code.ico">
	<link rel="stylesheet" href="style/foundation.min.css">
	<link rel="stylesheet" href="style/main.css">
</head>
<body>

<main role="main">
	<div class="row">
		<div class="columns small-12 large-12">

			<h1>Heroku</h1>
            <!-- https://www.freecodecamp.org/news/how-to-deploy-your-site-using-express-and-heroku/ -->
            <!-- https://www.taniarascia.com/node-express-postgresql-heroku/ -->

            <p>Create a free Heroko account at: <a href="https://signup.heroku.com/" target="_blank" rel="noopener noreferrer">https://signup.heroku.com/</a></p>

            <h2>Setup</h2>

            <p>On MacOS, it's recommended to use <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Homebrew</a> to install <strong>Heroku CLI</strong> locally onto your machine. If you haven't already installed Homebrew, use the following terminal command:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    </pre>
</div>
<!-- / Terminal -->

            <p>Homebrew is a package manager for MacOS and Linux. To verify the installation of Homebrew, use the following command:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ brew --version
    </pre>
</div>
<!-- / Terminal -->

            <p>The Heroku CLI requires Git. This will need to be installed and setup to use the CLI. Once Homebrew has been installed run the following command to install the Heroku CLI:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ brew tap heroku/brew && brew install heroku
    </pre>
</div>
<!-- / Terminal -->

            <p>To verify the installation of the CLI, use the command:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ heroku --version
    </pre>
</div>
<!-- / Terminal -->

            <p>You should see <strong>heroku/x.y.z</strong> in the output (x.y.z will be replaced by the version number).</p>

            <p>A warning was received following the upgrade to <strong>MacOS 11.2 (Big Sur)</strong>. The following commands were needed to get Heroku CLI installed:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ sudo rm -rf /Library/Developer/CommandLineTools
    $ sudo xcode-select --install
    </pre>
</div>
<!-- / Terminal -->

            <h2>Login to Heroku</h2>

            <p>You can login to Heroku using the Heroku CLI. You will need to have setup an Heroku account to do this. The default option to login to your account is through the web browser. You can also login to Heroku using the CLI via the terminal.</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ heroku login -i
    </pre>
</div>
<!-- / Terminal -->

            <p>Once logged in, you can create a new Heroku project. In this example, our project is named <strong>test-app</strong>.</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ heroku create test-app
    </pre>
</div>
<!-- / Terminal -->

            <ul>
                <li>Heroku will generate a random name for your project if you don't specify one in the command.</li>
                <li>The name will form part of the URL you can use to access your project.</li>
                <li>It is possible to rename your project later.</li>
            </ul>

            <p>If your application is created successfully, your URL will be generated within the terminal:</p>

<pre>
    <code>
<!-- Just leave this line alone -->
https://test-app.herokuapp.com/
https://git.heroku.com/test-app.git
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>To connect Heroku to GitHub, login to the Heroku dashboard and under the Deploy tab, connect your GitHub repository to your Heroku app.</p> 

            <a href="https://id.heroku.com/login" target="_blank" rel="noopener noreferrer">https://id.heroku.com/login</a></p>

            <p>You can deploy the <strong>main</strong> branch to the Heroku app from inside the dashboard. You may also need to set the remote:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ heroku git:remote -a test-app
    </pre>
</div>
<!-- / Terminal -->

            <p>We are getting an error in the logs, so we may need to add a script in the <strong>package.json</strong> file to run the NPM start command to spin up the Express server on Heroku:</p>

<pre>
    <code>
<!-- Just leave this line alone -->
"scripts": {
    "start": "node app.js",
    "test": "echo \"Error: no test specified\" && exit 1"
},
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>We can manually or automatically deploy changes to the app in Heroku from within the dashboard or use the terminal to push the changes to the app using the <strong>Heroku CLI</strong> if logged in:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ git push heroku main
    </pre>
</div>
<!-- / Terminal -->

            <p>Once Heroku and GitHub are connected, you will see an active environment being displayed within your GitHub repository.</p>

            <h2>Setting up an Express server</h2>

            <p>Begin by installing the Express server framework for NodeJS using NPM (Node Package Manager).</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ npm install express --save
    </pre>
</div>
<!-- / Terminal -->

        <p>The next step is to create a file called <strong>app.js</strong> which runs an Express server locally.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
// Require the Express module
const express = require('express')
// Create an instance of Express
const app = express()

// Use express.static middleware to serve static files from the folder specified
app.use(express.static('public'))

// Define a URL route using app.get
app.get('/', function(req, res) {
    // Respond with a simple HTML message
    res.send('&lt;h1&gt;Hello World&lt;/h1&gt;')
})

// Start the server on the port specified
app.listen(process.env.PORT || 3000, () => console.log('Server is running...'))
<!-- Just leave this line alone -->
    </code>
</pre>

            <ul>
                <li>The first two lines of code simply require the Express module and create an instance of Express named <strong>app</strong>.</li>
                <li>The next line requires the use of the <strong>express.static</strong> middleware. This lets static files (such as HTML, CSS & JavaScript) be served from the directory specified. In this case, the files will be served from a folder named <strong>public</strong>.</li>
                <li><strong>app.get()</strong> is used to define a URL route. Any URL requests to the root URL will be responded to with a simple HTML message.</li>
                <li>The final line of code starts the server. This will set the port to 3000.</li>
            </ul>

            <p>If you save the <strong>app.js</strong> file in the root of your project folder and run the following command, the server will run <a href="http://localhost:3000/" target="_blank" rel="noopener noreferrer">locally</a> on <strong>port 3000</strong>:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
    <div class="terminal__top">
        <div class="terminal__buttons">
            <span class="terminal__circle terminal__circle--red"></span>
            <span class="terminal__circle terminal__circle--yellow"></span>
            <span class="terminal__circle terminal__circle--green"></span>
        </div>
        <div class="terminal__title">bash -- 85x24</div>
    </div>
    <pre class="terminal__body">
<!-- Just leave this line alone -->
    $ node app.js
    </pre>
</div>
<!-- / Terminal -->

            <p><strong>Hello World</strong> will be displayed in the browser if the server is running successfully.</p>

            <p>We can create a <strong>public</strong> directory in the root of our project. From here we will host our static files such as HTML, CSS & JavaScript. Navigate to your public directory and create a HTML page named <strong>index.html</strong>.</p>

            <p>Update the <strong>app.js</strong> code to display the <strong>index.html</strong> file when the server is running.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
// Require the Express module
const express = require('express')
// Require the Path module
const path = require('path')
// Create an instance of Express
const app = express()

// Use express.static middleware to serve static files from the folder specified
app.use(express.static('public'))

// Define a URL route using app.get
app.get('/', function(req, res) {
    res.sendFile(path.join(__dirname + '/index.html'));
})

// Start the server on the port specified
app.listen(process.env.PORT || 3000, () => console.log('Server is running...'))
<!-- Just leave this line alone -->
    </code>
</pre>          

		</div>
	</div>
</main>

</body>
</html>