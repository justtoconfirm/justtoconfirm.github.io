<!DOCTYPE html>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A guide to Form & Form Validation">

	<title>Codebox - Form & Form Validation</title>

	<link rel="shortcut icon" type="image/ico" href="favicon/code.ico">
	<link rel="stylesheet" href="style/foundation.min.css">
	<link rel="stylesheet" href="style/main.css">

    <style>
        input[type=email] {
        -webkit-appearance: none;
        appearance: none;
        padding: 10px;
        border: 1px solid #333;
        margin: 0;
        font-family: inherit;
        box-sizing: border-box;
    }

    label {
        display: block;
        font-weight: bold;
    }

    /* This is our style for the invalid fields */
    input:invalid {
        border-color: #900;
        background-color: #FDD;
    }

    input:focus:invalid {
        outline: none;
    }
    </style>
</head>
<body>

<main role="main">
	<div class="row">
		<div class="columns small-12 large-12">

			<h1>Form & Form Validation</h1>
            <!-- https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation -->
            <!-- https://zellwk.com/blog/check-empty-input-js/ -->
            <!-- https://developer.mozilla.org/en-US/docs/Learn/Forms/Sending_and_retrieving_form_data -->
            <!-- https://pageclip.co/blog/2018-02-20-you-should-use-html5-form-validation.html -->
            <!-- https://github.com/Pageclip/valid-form -->
            <!-- https://stackoverflow.com/questions/38301774/how-to-do-floating-of-labels-in-css -->

            <p>For number fields, those with the <strong>type</strong> attribute of <strong>number</strong> for example, the <strong>min</strong> and <strong>max</strong> attributes can be used to provide a range of valid values. If the field contains a value outside this range, it will be invalid.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
&lt;input type="number" id="number" name="number" value="1" min="1" max="10"&gt;
&lt;input type="email" id="email-address" name="email-address" minlength="6" maxlength="8"&gt;
<!-- Just leave this line alone -->
    </code>
</pre>

            <h2>Events to validate input</h2>

            <p>If you want to validate the input when a user types into the field, you can use the <strong>input</strong> event:</p>

<pre>
    <code>
<!-- Just leave this line alone -->
const input = document.querySelector('input');

input.addEventListener('input', event => {
    // Validate input
})
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>If you want to validate the input when a user submits a form, you can use the <strong>submit</strong> event. Make sure you prevent the default behaviour with <strong>preventDefault</strong>. If you don't prevent the default behaviour, browsers will navigate to the URL stated in the action attribute.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
const input = document.querySelector('form');

form.addEventListener('submit', event => {
    event.preventDefault();
    
    // Validate input
})
<!-- Just leave this line alone -->
    </code>
</pre>

            <h2>Validation using JavaScript</h2>

            <p>You must use JavaScript if you want to take control over the look and feel of native error messages or to deal with legacy browsers that do no suppory the built-in HTML validation.</p>

            <p><a href="https://caniuse.com/constraint-validation" target="_blank" rel="noopener noreferrer">Most browsers support</a> the <strong>Constraint Validation API</strong> that consists of methods and properties.</p>

            <p>Let's start with some simple HTML:</p>

<pre>
    <code>
<!-- Just leave this line alone -->
&lt;form&gt;
    &lt;label for="email-address">E-mail:&lt;/label&gt;
    &lt;input type="email" id="email-address" name="email-address"&gt;
    &lt;button&gt;Submit&lt;/button&gt;
&lt;/form&gt;
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>Next, add the following JavaScript to the page:</p>

<pre>
    <code>
<!-- Just leave this line alone -->
const email = document.getElementById('email-address');

email.addEventListener('input', function(event) {
    if (email.validity.typeMismatch) {
        email.setCustomValidity('Please enter a valid e-mail address');
    } else {
        email.setCustomValidity('');
    }
});
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>Here's the form:</p>

            <!-- Demo code -->
            <form>
                <label for="email-address">E-mail:</label>
                <input type="email" id="email-address" name="email-address">
                <button>Submit</button>
            </form>
            <!-- / Demo code -->

            <p>Using CSS we can position position the <strong>&lt;label&gt;</strong> above the input field and the <strong>&lt;button&gt;</strong> below the input field by setting the <strong>display</strong> property to be <strong>block</strong>.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
label,
button {
    display: block;
}
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>The JavaScript code will check whether the email input's <strong>validity.typeMismatch</strong> property returns <strong>true</strong>, meaning the contained value doesn't match the pattern for an email address. If so, the <strong>setCustomValidity()</strong> method is called so we can pass in a custom message. This renders the input invalid, so the form submission will fail.</p>

            <p>If the property returns a value of <strong>false</strong>, an empty string is returned, the form input is valid, so the form will submit.</p>

            <p>We can use the <strong>novalidate</strong> attribute on the <strong>&lt;form&gt;</strong> element to turn off the browser's automatic validation. This lets our JavaScript code take control over the validation. This won't disable support for the <strong>Constraint Validation API</strong> nor CSS pseudo classes. This means that even though the browser doesn't automatically check the validity of the form before sending the data, we can do it ourselves and style the form accordingly.</p>

            <p>The <strong>novalidate</strong> attribute on the form simply stops the form from showing its own error message bubbles and allows us to style the error messages using our own styling.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
&lt;form novalidate&gt;
    
    &lt;!-- Form field here --&gt;

&lt;/form&gt;
<!-- Just leave this line alone -->
    </code>
</pre>

            <h2>HTML5 Validation Form</h2>
            <!-- https://pageclip.co/blog/2018-02-20-you-should-use-html5-form-validation.html -->

            <p>There are three categories of HTML5 form validation:</p>

            <ul>
                <li>HTML attributes on <strong>&lt;input&gt;</strong>, <strong>&lt;select&gt;</strong>, and <strong>&lt;textarea&gt;</strong> elements.</li>
                <li>CSS pseudo classes.</li>
                <li>JavaScript APIs.</li>
            </ul>

            <p>Begin by adding a required attribute to an <strong>&lt;input&gt;</strong> to ensure the user needs to add something into the input field. The type attribute is also set to allow only email addresses. As the input field is required, you cannot submit the form unless an email address is entered.</p>

            <p>The <strong>for</strong> attribute for the label needs to match the <strong>id</strong> of the input field.</p>

            <p>This is only HTML, no JavaScript.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
&lt;form&gt;
    
    &lt;label for="mail"&gt;Email:&lt;/label&gt;
    &lt;input id="mail" type="email" name="email" placeholder="a@b.com" required&gt;

    &lt;button&gt;Login&lt;/button&gt;

&lt;/form&gt;
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>There are a couple of CSS pseudo classes we can use to style the input:</p>

            <ul>
                <li><strong>:valid</strong> - when the input is valid</li>
                <li><strong>:invalid</strong> - when the input is invalid</li>
            </ul>

            <p>The most basic approach would be to change the border colour when the input is invalid.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
input:invalid {
    border-color: red;
}
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>This is not ideal.</p>

            <ul>
                <li>The input is required and initially empty, so on page load the input is <strong>:invalid</strong> and the border is red.</li>
                <li>The input is <strong>:invalid</strong> until you type a valid email address into the field, so it is always red when the user is typing.</li>
            </ul>

            <p>A better solution is to use the input's <strong>invalid</strong> event instead of using the <strong>:invalid</strong> pseudo CSS class selector, to add a CSS class for styling if the input is invalid. We can remove this CSS class when the element becomes valid once again.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
input.invalid {
    border-color: red;
}
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>And the JavaScript that will add the invalid class when the input is invalid.</p>

<pre>
    <code>
<!-- Just leave this line alone -->
const inputs = document.querySelectorAll('input, select, textarea')

inputs.forEach(function(input) {
    
    // Add a CSS class on submit when the input is invalid
    input.addEventListener('invalid', function() {
        input.classList.add('invalid')
    })

    // Remove the CSS class when the input becomes valid, this will fire each time user types
    input.addEventListener('input', function() {
        if (input.validity.valid) {
            input.classList.remove('invalid')
        }
    })

})
<!-- Just leave this line alone -->
    </code>
</pre>

            <p>The default error messaging will still apply.</p>

		</div>
	</div>
</main>

<script>
const email = document.getElementById('email-address');

email.addEventListener('input', function(event) {
    if (email.validity.typeMismatch) {
        email.setCustomValidity('Please enter a valid e-mail address');
    } else {
        email.setCustomValidity('');
    }
});
</script>

</body>
</html>