<!DOCTYPE html>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Introduction to the Redux">

	<title>Codebox | Redux | Introduction</title>

	<link rel="shortcut icon" type="image/ico" href="../favicon/code.ico">
	<link rel="stylesheet" href="../dist/css/main.css">
	<link rel="preload" href="../fonts/darker-grotesque-v2-latin/darker-grotesque-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
</head>
<body>

	<header role="banner">
		<a href="../index.html">Home</a>

		<nav>
			<ul class="nav-list">
				<!--<li class="nav-list__item"><a href="introduction-to-php.html">React</a></li>
				<li class="nav-list__item"><a href="introduction-to-wordpress.html">WordPress</a></li>-->
			</ul>

			<div class="hamburger">
				<span class="bar"></span>
				<span class="bar"></span>
				<span class="bar"></span>
			</div>
		</nav>
	</header>

	<div class="menu">
		<ul class="menu__list">
			<!--<li class="menu__list-item">
				<a href="javascript.html" class="menu__list-link">JavaScript</a>
			</li>-->
		</ul>
	</div>

	<main role="main">

		<div class="intro">

			<div class="container">
				<div class="row">
					<div class="column">

						<h1 class="intro__heading">Redux</h1>

						<p class="intro__copy">An introduction to Redux and how to set it up.</p>

					</div><!-- / column -->
				</div><!-- / row -->
			</div><!-- / container -->

		</div><!-- / intro -->

		<div class="container">
			<div class="row">
				<div class="column">

					<section>
						<h2>Introduction</h2>

						<p>The Redux Toolkit was created to address three common concerns about Redux:</p>

						<ul>
							<li>Configuration of a Redux store is too complicated.</li>
							<li>Packages need to be added to get Redux to do anything useful.</li>
							<li>Redux requires lots of boilerplate code.</li>
						</ul>

						<p>Redux, without the use of React Toolkit, does require a lot of initial boilerplate set up. A small application may not need Redux and may instead benefit from using the <strong>Context API</strong> for global state needs.</p>
					</section>

					<section>
						<h2>What is Redux?</h2>

						<p>Redux is a state container for JavaScript (or TypeScript) applications. Normally, with React, you manage state at the component level and use props to pass around the state. With Redux, the entire state of your application is managed in one object.</p>

						<p>Every update to the Redux state results in a copy of sections of the state, plus the new change. This is because the object is immutable (unable to change).</p>

						<p>We can easily access or update any part of the state from any Redux-connected component.</p>
					</section>

					<section>
						<h2>Terminology</h2>

						<p>Redux has a number of key terms and definitions to become familar with:</p>

						<ul>
							<li>Actions</li>
							<li>Reducers</li>
							<li>Store</li>
							<li>Dispatch</li>
							<li>Connect</li>
						</ul>

						<h3>Actions</h3>

						<ul>
							<li>An action sends data from your application to the Redux store.</li>
							<li>It is an object with two properties, <strong>type</strong> and <strong>payload</strong> (optional).</li>
							<li>The <strong>type</strong> is generally an uppercase string (a constant) that describes the action, like <strong>DELETE_TODO</strong>, or <strong>ADD_TODO</strong>, for example.</li>
							<li>The <strong>payload</strong> is additional data that maybe passed.</li>
						</ul>

						<p>An <strong>action creator</strong> is a function that returns an action.</p>

						<h3>Reducer</h3>

						<ul>
							<li>A reducer is a function that takes two parameters - <strong>state</strong> and <strong>action</strong>.</li>
							<li>A reducer returns a copy of the entire state.</li>
							<li>It typically consists of a <strong>switch</strong> statement that goes through all the action types.</li>
						</ul>

						<h3>Store</h3>

						<ul>
							<li>The state of the application lives in the store.</li>
							<li>The store is an object containing the state that can be accessed across the application by any components that are connected to Redux.</li>
							<li>When used with React, a <strong>&lt;Provider&gt;</strong> exists to wrap the applicatin. Anything with this Provider can then access Redux.</li>
						</ul>

						<h3>Dispatch</h3>

						<ul>
							<li>The store object has a method - <strong>dispatch</strong> - that accepts an object used to update the Redux state.</li>
							<li>This is usually invoked by an action creator.</li>
						</ul>

						<h3>Connect</h3>

						<p>The <strong>connect()</strong> function is one way to typically connect React to Redux. A connected component is sometimes referred to as a container.</p>
					</section>

					<section>
						<h2>Install</h2>

						<p>The recommended way to start a new app with React and Redux is by using the template for <strong>create-react-app</strong>. This takes advantage of the Redux Toolkit and integration with React components.</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	# Redux + Plain JavaScript template
	npx create-react-app APP-NAME-HERE --template redux

	# Redux + TypeScript template
	npx create-react-app APP-NAME-HERE --template redux-typescript
    
	</pre>
</div>
<!-- / Terminal -->

					<p>With an existing app, the React Toolkit npm package can be installed:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	# npm
	npm install @reduxjs/toolkit

	# Yarn
	yarn add @reduxjs/toolkit
    
	</pre>
</div>
<!-- / Terminal -->

					</section>

					<section>
						<h2>Getting Started</h2>

						<p>We will begin by using the <strong>create-react-app</strong> tool to setup the React application. Our application will be called <strong>learning-redux</strong>.</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	npx create-react-app learning-redux
	
	cd learning-redux
    
	</pre>
</div>
<!-- / Terminal -->

						<p>Redux required a few dependencies:</p>

						<ul>
							<li><strong>Redux</strong> - the core library</li>
							<li><strong>React Redux</strong> - React bindings for Redux</li>
							<li><strong>Redux Thunk</strong> - Async middleware for Redux</li>
							<li><strong>Redux DevTools</strong> - Connects the Redux app to Redux DevTools</li>
						</ul>

						<p>Install the dependencies:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	npm install redux react-redux redux-thunk redux-devtools-extension
    
	</pre>
</div>
<!-- / Terminal -->

						<p>Delete all the boilerplate code from inside the <strong>src</strong> director.</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	cd src && rm *			# move to src and delete all files within
    
	</pre>
</div>
<!-- / Terminal -->

						<p>Now that all the boilerplate code has been removed, we can make directories for Redux reducers, actions, as well as pages and React components in the <strong>src</strong> directory.</p> 

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	mkdir actions components pages reducers
    
	</pre>
</div>
<!-- / Terminal -->

						<p>We will also bring back a number of the files we removed:</p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	touch index.js index.css App.js
    
	</pre>
</div>
<!-- / Terminal -->

						<p>Our file structure should look like this:</p>

<pre>
	<code>

src /
	|_actions /
	|_components /
	|_pages /
	|_reducers /
	|_App.js
	|_index.css
	|_index.js

	</code>
</pre>
					</section>

					<section>
						<h2>Setup the Redux Store</h2>

						<p>We just want to get the App up and running for now, so in the <strong>src/App.js</strong> file add the following code:</p>

<pre>
	<code>

import React from 'react';

const App = () => {
	
	return (
		&lt;h1&gt;Hello Redux&lt;/h1&gt;
	);
};

export default App;

	</code>
</pre>

						<p>Next, update the <strong>src/index.js</strong> file to render the App component and import the packages and tools we need to setup Redux.</p>

<pre>
	<code>

// External imports
import React from 'react';
import { render } from 'react-dom';
import { createStore, applyMiddleware } from 'redux';
import { Provider } from 'react-redux';
import thunk from 'redux-thunk';
import { composeWithDevTools } from 'redux-devtools-extension';

// Local imports
import App from './App';

// Assets
import './index.css';

// Redux Store
const store = createStore(
	composeWithDevTools(applyMiddleware(thunk))
);

render(
	&lt;Provider store={store}&gt;
		&lt;App /&gt;
	&lt;/Provider&gt;,
	document.getElementById('root')
);

	</code>
</pre>

						<p>Within the <strong>src/index.js</strong> file, we will be bringing in a few things:</p>

						<ul>
							<li><strong>createStore</strong> - to create the Redux store that will maintain our application's state.</li>
							<li><strong>applyMiddleware</strong> - to allow middleware to be used, in this case thunk.</li>
							<li><strong>thunk</strong> - a middleware that allows us to make asynchronous actions in Redux.</li>
							<li><strong>Provider</strong> - to wrap the entire React application in Redux.</li>
							<li><strong>composeWithDevTools</strong> - code that connects your app to Redux DevTools.</li>
						</ul>
					</section>

					<section>
						<h2>Setup the Reducers</h2>

						<p>A reducer is a function that determines changes to Redux state. It returns a copy of the state with the new change and has two parameters, <strong>state</strong> and <strong>action</strong>.</p>

						<p>Here we will make a reducer named <strong>postsReducer</strong>. This will be setup with an initial state containing an empty posts array where all the posts will live. First, we will set it up with no actions in the switch, just a default case the returns the entire state.</p>

						<p>Create the <strong>reducer/postsReducer.js</strong> file with the following code:</p>

<pre>
	<code>

export const initialState = {
	posts: [],
}

export default function postsReducer(state = initialState, action) {
	switch (action.type) {
		default:
			return state
	};
};

	</code>
</pre>

						<p>In Redux, we can have many reducers and combine them into one root reducer that the Redux store can use, using <strong>combineReducers</strong>.</p>

						<p>Create a <strong>reducers/index.js</strong> file that will combine all our reducers:</p>

<pre>
	<code>

import { combineReducers } from 'redux';

// Import the individual reducers to combine them into one root reducer
import postsReducer from './postsReducer';

// List each reducer here
const rootReducer = combineReducers({
	posts: postsReducer,
});

export default rootReducer;

	</code>
</pre>

						<p>Now, update our <strong>src/index.js</strong> file to add the rootReducer to connect to our Redux store.</p>

<pre>
	<code>

// External imports
import React from 'react';
import { render } from 'react-dom';
import { createStore, applyMiddleware } from 'redux';
import { Provider } from 'react-redux';
import thunk from 'redux-thunk';
import { composeWithDevTools } from 'redux-devtools-extension';

// Local imports
import App from './App';
import rootReducer from './reducers';		// Import all reducers using the combineReducers Redux method

// Assets
import './index.css';

// Redux Store
const store = createStore(
	rootReducer,							// Connect all reducers to the Redux store
	composeWithDevTools(applyMiddleware(thunk))
);

render(
	&lt;Provider store={store}&gt;
		&lt;App /&gt;
	&lt;/Provider&gt;,
	document.getElementById('root')
);

	</code>
</pre>
					</section>

					<section>
						<h2>Setup Actions</h2>

						<p>Without actions, the reducer will only return the state without modifying it. Actions allow us to communicate with the Redux store. For this app, we are going to want to fetch posts from an API and put them into our Redux store.</p>

						<p>Since fetching the posts is an asychronous action, it will require the use of the Redux <strong>thunk</strong> middleware.</p>

						<p>Create an <strong>src/actions/postsActions.js</strong> file first which we will use to define the action types and constants. We want to do three things:</p>

						<ul>
							<li><strong>getPosts</strong> - begin telling Redux that we're going to fetch posts from an API.</li>
							<li><strong>getPostsSuccess</strong> - pass the posts to Redux on a successful API call.</li>
							<li><strong>getPostsFailure</strong> - inform Redux if an error was encountered during a failed API call.</li>
						</ul>

<pre>
	<code>

// Create Redux action types
export const GET_POSTS = 'GET_POSTS';
export const GET_POSTS_SUCCESS = 'GET_POSTS_SUCCESS';
export const GET_POSTS_FAILURE = 'GET_POSTS_FAILURE';

	</code>
</pre>

						<p>Below this code, we then create <strong>action creators</strong>. These are functions that return an action, which consists of the <strong>type</strong> and <strong>payload</strong> (optional) containing the data.</p>

<pre>
	<code>

// Create Redux action creators that return an action
export const getPosts = () => ({
	type: GET_POSTS,
});

export const getPostsSuccess = (posts) => ({
	type: GET_POSTS_SUCCESS,
	payload: posts,
});

export const getPostsFailure = () => ({
	type: GET_POSTS_FAILURE,
});

	</code>
</pre>

						<p>We can use the <strong>thunk</strong> action to combine all three of these actions. When called, it will dispatch the initial <strong>getPosts()</strong> action to inform Redux to prepare for an API call, then in a try/catch, it will do everything necessary to get the data and dispatch a success or failure action if needed.</p>

<pre>
	<code>

// Combine all actions in an asynchronous thunk
export function fetchPosts() {
	return async (dispatch) => {
		dispatch(getPosts());

		try {
			const response = await fetch('https://jsonplaceholder.typicode.com/posts');
			const data = await response.json();

			dispatch(getPostsSuccess(data));
		} catch (error) {
			dispatch(getPostsFailure());
		}
	};
};

	</code>
</pre>

						<p>Our actions are now created. We now need to tell the reducer what to do with the state on each action.</p>
					</section>

					<section>
						<h2>Adding our Actions</h2>

						<p>Back to our reducer, we have a switch statement that isn't doing anything apart from returning the state as a default.</p>

						<p>Now that we have actions, we can bring them in from the <strong>src/actions/postsActions.js</strong> code. Open the <strong>src/reducers/index.js</strong> file and import our actions:</p>

<pre>
	<code>

// Import all actions
import * as actions from '../actions/postsActions';

	</code>
</pre>

						<p>For each action, we will make a <strong>case</strong> within the switch statement, that returns the entire state plus whatever change we make to the state. <strong>GET_POSTS</strong>, for example, will return the state and tell the app to set <strong>loading</strong> to <strong>true</strong> since we will be making an API call.</p>

						<ul>
							<li><strong>GET_POSTS</strong> - begin loading</li>
							<li><strong>GET_POSTS_SUCCESS</strong> - the app has posts, no errors, should stop loading</li>
							<li><strong>GET_POSTS_FAILURE</strong> - the app has errors and should stop loading</li>
						</ul>

						<p>We have updated the reducers further by setting the initial state with two empty arrays, one called <strong>loading</strong>, the other <strong>hasErrors</strong>.</p>

<pre>
	<code>

// Import all actions
import * as actions from '../actions/postsActions';

export const initialState = {
	posts: [],
	loading: false,
	hasErrors: false,
}

export default function postsReducer(state = initialState, action) {
	switch (action.type) {
		case actions.GET_POSTS:
			return {
				...state, loading: true
			}
		case actions.GET_POSTS_SUCCESS:
			return {
				posts: action.payload, loading: false, hasErrors: false
			}
		case actions.GET_POSTS_FAILURE:
			return {
				...state, loading: false, hasErrors: true
			}
		default:
			return state
	};
};

	</code>
</pre>

						<p>Now that the actions and reducers are ready, we just need to connect everything to the React app.</p>
					</section>

					<section>
						<h2>Connecting Redux to React Components</h2>

						<p>We will begin by creating a very simple React component for displaying the posts. This will be within a file named <strong>src/pages/PostsPage.js</strong></p>

<pre>
	<code>

import React from 'react';

const PostsPage = () => {
	
	return (
		&lt;section&gt;
			&lt;h1&gt;Posts&lt;/h1&gt;
		&lt;/section&gt;
	);
};

export default PostsPage;

	</code>
</pre>

						<p>We will then bring in <strong>connect</strong>. This is an higher-order function that connects our React component to the Redux store.</p>

						<p>Here we are also passing the Redux state as props into our component also.</p>

<pre>
	<code>

import React from 'react';
import { connect } from 'react-redux';

// Redux state is now in the props of the component
const PostsPage = ({ loading, posts, hasErrors }) => {
	
	return (
		&lt;section&gt;
			&lt;h1&gt;Posts&lt;/h1&gt;
		&lt;/section&gt;
	);
};

// Connect Redux to React
export default connect(PostsPage);

	</code>
</pre>

						<p>We will pass a parameter called <strong>mapStateToProps</strong> to <strong>connect</strong>. This will take any state from the Redux store and pass it to the props of the React component. We will bring in <strong>loading</strong>, <strong>posts</strong>, and <strong>hasErrors</strong> from the Redux <strong>postsReducer</strong>.</p>

<pre>
	<code>

import React from 'react';
import { connect } from 'react-redux';

// Redux state is now in the props of the component
const PostsPage = ({ loading, posts, hasErrors }) => {
	
	return (
		&lt;section&gt;
			&lt;h1&gt;Posts&lt;/h1&gt;
		&lt;/section&gt;
	);
};

// Map Redux state to React component props
const mapStateToProps = (state) => ({
	loading: state.posts.loading,
	posts: state.posts.posts,
	hasErrors: state.posts.hasErrors,
});

// Connect Redux to React
export default connect(mapStateToProps)(PostsPage);

	</code>
</pre>

						<p>We now want to bring in the asynchronous <strong>fetchPosts</strong> from the actions. Using the <strong>useEffect</strong> React hook, we can dispatch the fetchPosts action when the component mounts.</p>

<pre>
	<code>

import React, { useEffect } from 'react';
import { connect } from 'react-redux';

// Bring in the asynchronous fetchPosts action
import { fetchPosts } from '../actions/postsActions';

// Redux state is now in the props of the component
const PostsPage = ({ dispatch, loading, posts, hasErrors }) => {

	isEffect(() => {
		dispatch(fetchPosts())
	}, [dispatch]);
	
	return (
		&lt;section&gt;
			&lt;h1&gt;Posts&lt;/h1&gt;
		&lt;/section&gt;
	);
};

// Map Redux state to React component props
const mapStateToProps = (state) => ({
	loading: state.posts.loading,
	posts: state.posts.posts,
	hasErrors: state.posts.hasErrors,
});

// Connect Redux to React
export default connect(mapStateToProps)(PostsPage);

	</code>
</pre>

						<p>For each post we can create a simple <strong>Post</strong> component that will display the title and the excerpt of the text from the article. Create a new file named <strong>src/components/Post.js</strong></p>

<pre>
	<code>

import React from 'react';

const Post = ({ post }) => {
	
	return (
		&lt;article&gt;
			&lt;h2&gt;{post.title}&lt;/h2&gt;
			&lt;p&gt;{post.body.substring(0, 100)}&lt;/p&gt;
		&lt;/article&gt;
	);
};

export default Post;

	</code>
</pre>

						<p>Now update the <strong>src/pages/PostsPage.js</strong> component to display all three possible states of the page - whether it's loading, has an error, or has successfully retrieved the posts from the API.</p>

						<p>Here we will import the Post component:</p>

<pre>
	<code>

import React, { useEffect } from 'react';
import { connect } from 'react-redux';

// Bring in the asynchronous fetchPosts action
import { fetchPosts } from '../actions/postsActions';
// Import the Post component
import Post from '../components/Post';

// Redux state is now in the props of the component
const PostsPage = ({ dispatch, loading, posts, hasErrors }) => {

	useEffect(() => {
		dispatch(fetchPosts())
	}, [dispatch]);

	// Show loading, error, or success state
	const renderPosts = () => {
		if (loading) return &lt;p&gt;Loading posts...&lt;/p&gt;
		if (hasErrors) return &lt;p&gt;Unable to display posts.&lt;/p&gt;
		return posts.map((post) => &lt;Post key={post.id} post={post} /&gt;)
	};
	
	return (
		&lt;section&gt;
			&lt;h1&gt;Posts&lt;/h1&gt;
			{renderPosts()}
		&lt;/section&gt;
	);
};

// Map Redux state to React component props
const mapStateToProps = (state) => ({
	loading: state.posts.loading,
	posts: state.posts.posts,
	hasErrors: state.posts.hasErrors,
});

// Connect Redux to React
export default connect(mapStateToProps)(PostsPage);

	</code>
</pre>

						<p>We now have a connected component and are bringing in data from an API to our Redux store. We can use Redux DevTools to see each action as it happens and changes after each state change.</p>

						<p>We now need to update the <strong>src/App.js</strong> code so we can render the <strong>src/pages/PostsPage</strong> component:</p>

<pre>
	<code>

import React from 'react';
import PostsPage from './pages/PostsPage';

const App = () => {
	
	return (
		&lt;PostsPage /&gt;
	);
};

export default App;

	</code>
</pre>
					</section>

					<section>
						<h2>Redux Toolkit (RTK)</h2>

						<p>Redux Tookit (RTK) is a newer, and official, way of using Redux. This reduces the need for the large boilerplate code needed for the setup of Redux.</p>

						<p>Using RTK requires just a single dependency: <strong>@reduxjs/toolkit</strong></p>

<!-- Terminal -->
<div class="terminal terminal--shadow">
	<div class="terminal__top">
		<div class="terminal__buttons">
			<span class="terminal__circle terminal__circle--red"></span>
			<span class="terminal__circle terminal__circle--yellow"></span>
			<span class="terminal__circle terminal__circle--green"></span>
		</div>
		<div class="terminal__title">bash -- 85x24</div>
	</div>
	<pre class="terminal__body">

	npm install @reduxjs/toolkit
    
	</pre>
</div>
<!-- / Terminal -->

						<p>We also no longer need to install <strong>redux-thunk</strong> or <strong>redux-devtools-extension</strong> dependencies as these are built into RTK.</p>

						<p>Other advantages include:</p>

						<ul>
							<li>Easier to setup (less dependencies)</li>
							<li>Reduction of boilerplate code</li>
							<li>Dependencies - Redux Thunk, Redux DevTools, built in</li>
							<li>Ability to use <strong>direct state mutation</strong>, since RTK uses <strong>immer</strong> under the hood. This means we no longer need to return <strong>{...state}</strong> with every reducer.</li>
						</ul>

						<h3>Create Store</h3>

						<p>To create the Redux store, we only need to use <strong>configureStore</strong> instead of <strong>createStore</strong>.</p>

						<p>We can update the <strong>src/index.js</strong> file like so:</p>

<pre>
	<code>

// External imports
import React from 'react';
import { render } from 'react-dom';
import { configureStore } from 'redux';
import { Provider } from 'react-redux';

// Local imports
import App from './App';
// Import Slices - automatically generate reducers, action types, and action creators
import rootReducer from './slices';

// Assets
import './index.css';

// Redux Store (RTK)
const store = configureStore({ reducer: rootReducer });

render(
	&lt;Provider store={store}&gt;
		&lt;App /&gt;
	&lt;/Provider&gt;,
	document.getElementById('root')
);

	</code>
</pre>

						<h3>Slices</h3>

						<p>Slices automatically generates reducers, action types, and action creators in a single folder named <strong>slices</strong>. This removes the need to deal with reducers and actions as seperate files and individually creating those action types.</p>

						<p>The name of the reducers in the slice will remain the same - <strong>getPosts</strong>, <strong>getPostsSuccess</strong>, and <strong>getPostsFailure</strong> - but we no longer need to return the entire state, we just mutate the state in our slice.</p>

						<p>The actions that get generated are the same, we just don't have to write them out individually. We can export all the action, the reducers,the asynchronous think, and one new thing - a <strong>selector</strong> - whih we use to access any of the state from a React component instead of <strong>connect</strong>.</p>

						<p>This would be the code for <strong>src/slices/posts.js</strong>:</p>

<pre>
	<code>

import { createSlice } from '@reduxjs/toolkit';

export const initialState = {
	posts: [],
	loading: false,
	hasErrors: false,
};

// A slice for posts with our three reducers
const postsSlice = createSlice({
	name: 'posts',
	initialState,
	reducers: {
		getPosts: (state) => {
			state.loading = true
		},
		getPostsSuccess: (state, { payload }) => {
			state.posts = payload
			state.loading = false
			state.hasErrors = false
		},
		getPostsFailure: (state) => {
			state.loading = false
			state.hasErrors = true
		},
	},
});

// Three actions generated from the slice
export const { getPosts, getPostsSuccess, getPostsFailure } = postsSlice.actions;

// A selector
export const postsSelector = (state) => state.posts;

// The reducer
export default postsSlice.reducer;

// Asynchronous thunk action
export function fetchPosts() {
	return async (dispatch) => {
		dispatch(getPosts())

		try {
			const response = await fetch('https://jsonplaceholder.typicode.com/posts');
			const data = await response.json();

			dispatch(getPostsSuccess(data));
		} catch (error) {
			dispatch(getPostsFailure());
		}
	};
};

	</code>
</pre>

						<p>In traditional Redux applications, we used <strong>mapStateToProps</strong> with the <strong>connect()</strong> function, but with RTK, we can use React Hooks and <strong>useDispatch</strong>, <strong>useSelector</strong> from <strong>react-redux</strong>. This approach requires less code overall.</p>

						<p>We can update the <strong>src/pages/PostsPage.js</strong> code to use RTK:</p>

<pre>
	<code>

import React, { useEffect } from 'react';
import { useDispatch, useSelector } from 'react-redux';

import { fetchPosts, postsSelector } from '../slices/posts';

// Import the Post component
import Post from '../components/Post';

const PostsPage = () => {
	const dispatch = useDispatch();
	// Redux state is now in the props of the component
	const { posts, loading, hasErrors } = useSelector(postsSelector);	

	useEffect(() => {
		dispatch(fetchPosts())
	}, [dispatch]);

	// Show loading, error, or success state
	const renderPosts = () => {
		if (loading) return &lt;p&gt;Loading posts...&lt;/p&gt;
		if (hasErrors) return &lt;p&gt;Unable to display posts.&lt;/p&gt;
		
		return posts.map((post) => &lt;Post key={post.id} post={post} /&gt;)
	};
	
	return (
		&lt;section&gt;
			&lt;h1&gt;Posts&lt;/h1&gt;
			{renderPosts()}
		&lt;/section&gt;
	);
};

export default PostsPage;

	</code>
</pre>

						<p>We have the same app as before using Redux Toolkit (RTK), but loss less code to maintain.</p>

						<p>Here's our code structure:</p>

<pre>
	<code>

src /
	|_components /
		|_Post.js
	|_pages /
		|_PostsPage.js
	|_slices /
		|_posts.js
	|_App.js
	|_index.css
	|_index.js

	</code>
</pre>
					</section>

					<section>
						<h2>Useful Links</h2>

						<ul>
							<li><a href="https://www.taniarascia.com/redux-react-guide/" target="_blank" rel="noopener noreferrer">Tania Rascia: Redux Tutorial</a></li>
							<li><a href="https://github.com/justtoconfirm/learning-redux" target="_blank" rel="noopener noreferrer">Source Code: Demo application (GitHub)</a></li>
						</ul>
					</section>

				</div>
			</div>
		</div>

	</main>

	<footer>
		<a href="../sitemap.html">Sitemap</a>
	</footer>

	<script src="../dist/js/menu.js"></script>

</body>
</html>